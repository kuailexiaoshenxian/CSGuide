# 常见的内存错误

**面试高频指数：★★★★☆**

大家好，我是小北。

内存，一定是 C/C++ 面试中重点考察的部分，考察形式很多，有提问内存管理、指针的理解，也有给出一段代码，问你这段代码里有什么内存问题。

而且日常工作中，往往也出现和内存有关的错误，包括各种 segmentfault、coredump等等，那么这篇文章中就帮大家汇总了 C/C++ 中常见的内存错误。

#### 1. 间接引用坏指针

要知道进程的虚拟地址空间中有较大的空洞，没有映射到任何有意义的数据。

如果我们试图间接引用一个指向这些洞的指针，那么操作系统就会以段异常中止程序。

而且，虚拟内存的某些区域是只读的，试图写这些区域将会以保护异常中止这个程序。

间接引用坏指针的一个常见示例是经典的 scanf 错误。

假设我们想要使用 scanf 从 stdin 读一个整数到一个变量。

正确的方法是传递给 scanf 一个格式串和变量的地址：

```cpp
int val;
scanf("%d", &val)`
```

然而，对于不少 C/C++ 初学者而言（对有经验者也是如此！），很容易传递 val 的内容，而不是它的地址：

```cpp
scanf("%d", val)
```

在这种情况下，scanf 将把 val 的内容解释为一个地址，并试图将一个字写到这个位置。

在最好的情况下，程序立即以异常终止。在最糟糕的情况下，val 的内容对应于虚拟内存的某个合法的读/写区域，于是我们就覆盖了这块内存。



https://hansimov.gitbook.io/csapp/part2/ch09-virtual-memory/9.11-common-memoory-related-bugs-in-c-programs


https://github.com/imarvinle/awesome-cs-books

